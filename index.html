<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Flight Search</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

  <!-- Search -->
  <section id="search" class="py-8 bg-white shadow">
    <div class="max-w-3xl mx-auto bg-slate-50 p-8 rounded-2xl shadow">
      <h2 class="text-2xl font-bold mb-6">Search Flights</h2>
      <form id="searchForm" class="grid md:grid-cols-2 gap-4">
        <!-- From -->
        <input id="from" list="airports" placeholder="From (e.g. DEL)" class="px-4 py-3 rounded-lg border"/>
        <!-- To -->
        <input id="to" list="airports" placeholder="To (e.g. YYZ)" class="px-4 py-3 rounded-lg border"/>
        <!-- Dates -->
        <input type="date" id="depDate" class="px-4 py-3 rounded-lg border"/>
        <input type="date" id="retDate" class="px-4 py-3 rounded-lg border"/>
        <!-- Cabin -->
        <select id="cabin" class="px-4 py-3 rounded-lg border">
          <option>Economy</option>
          <option>Business</option>
          <option>First</option>
        </select>
        <!-- Passengers -->
        <input type="number" min="1" value="1" id="pax" class="px-4 py-3 rounded-lg border"/>
        <!-- Submit -->
        <button type="submit" class="md:col-span-2 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg">Show Deals</button>
      </form>

      <!-- Airport codes -->
      <datalist id="airports">
        <!-- India -->
        <option value="DEL">New Delhi</option>
        <option value="BOM">Mumbai</option>
        <option value="BLR">Bengaluru</option>
        <option value="MAA">Chennai</option>
        <option value="CCU">Kolkata</option>
        <!-- Canada -->
        <option value="YYZ">Toronto</option>
        <option value="YVR">Vancouver</option>
        <option value="YUL">Montreal</option>
        <option value="YYC">Calgary</option>
        <option value="YEG">Edmonton</option>
        <!-- USA -->
        <option value="JFK">New York</option>
        <option value="EWR">New Jersey</option>
        <option value="LAX">Los Angeles</option>
        <option value="ORD">Chicago</option>
        <option value="DFW">Dallas</option>
        <option value="SFO">San Francisco</option>
        <option value="MIA">Miami</option>
        <option value="BOS">Boston</option>
      </datalist>
    </div>
  </section>

  <!-- Filters -->
  <div class="max-w-3xl mx-auto mt-6 bg-slate-50 p-4 rounded-lg shadow">
    <h3 class="font-bold mb-2">Filter Results</h3>
    <div class="flex flex-wrap gap-4">
      <!-- Non-stop -->
      <label class="flex items-center gap-2">
        <input type="checkbox" id="filterNonStop"> Non-stop only
      </label>
      <!-- Airline -->
      <label>
        Airline:
        <select id="filterAirline" class="px-2 py-1 border rounded">
          <option value="">All</option>
        </select>
      </label>
      <!-- Region -->
      <label>
        Region:
        <select id="filterRegion" class="px-2 py-1 border rounded">
          <option value="">All</option>
          <option value="Canada">Canada</option>
          <option value="USA">USA</option>
          <option value="India">India</option>
        </select>
      </label>
      <!-- Price -->
      <label>
        Max Price (CAD):
        <input type="number" id="filterPrice" placeholder="e.g. 800" class="px-2 py-1 border rounded w-24">
      </label>
    </div>
  </div>

  <!-- Sorting -->
  <div class="max-w-3xl mx-auto mt-4 flex gap-2">
    <button onclick="sortFlights('price')" class="bg-gray-200 px-4 py-2 rounded">Sort by Price</button>
    <button onclick="sortFlights('duration')" class="bg-gray-200 px-4 py-2 rounded">Sort by Duration</button>
    <button onclick="sortFlights('departure')" class="bg-gray-200 px-4 py-2 rounded">Sort by Departure</button>
  </div>

  <!-- Results -->
  <div id="results" class="max-w-3xl mx-auto mt-6"></div>

  <script>
    let flights = [];

    // Demo airlines
    const airlines = ["Air India", "IndiGo", "Air Canada", "Delta", "United", "American Airlines"];

    // Generate random flights
    function generateFlights() {
      flights = [];
      for (let i = 0; i < 8; i++) {
        const fromList = ["DEL","BOM","YYZ","YVR","JFK","SFO"];
        const toList = ["YYZ","YVR","DEL","BOM","JFK","SFO"];
        const from = fromList[Math.floor(Math.random()*fromList.length)];
        const to = toList[Math.floor(Math.random()*toList.length)];
        const airline = airlines[Math.floor(Math.random()*airlines.length)];
        const priceCAD = Math.floor(Math.random()*500 + 400);
        flights.push({
          airline,
          flight: "AI-" + Math.floor(Math.random()*900+100),
          from, to,
          dep: "2025-09-01T0"+Math.floor(Math.random()*9)+":00",
          arr: "2025-09-01T1"+Math.floor(Math.random()*9)+":00",
          duration: Math.floor(Math.random()*400 + 100),
          priceCAD,
          priceUSD: Math.floor(priceCAD*0.74),
          priceINR: Math.floor(priceCAD*62),
          status: "On Time"
        });
      }
      renderFlights(flights);
    }

    // Render
    function renderFlights(list) {
      let html = "";
      if (list.length === 0) {
        html = "<p>No flights match your filters.</p>";
      } else {
        // Fill airline filter
        const airlineSet = [...new Set(flights.map(f => f.airline))];
        const airlineDropdown = document.getElementById("filterAirline");
        if (airlineDropdown.options.length === 1) {
          airlineSet.forEach(a => {
            airlineDropdown.innerHTML += `<option value="${a}">${a}</option>`;
          });
        }

        list.forEach(f => {
          const details =
            `Airline: ${f.airline}\nFlight: ${f.flight}\nFrom: ${f.from}\nTo: ${f.to}\nDeparture: ${f.dep}\nPrice: ${f.priceCAD} CAD | ${f.priceUSD} USD | â‚¹${f.priceINR} INR`;
          const whatsappLink = `https://wa.me/917009767211?text=${encodeURIComponent("Hi, I want to book this flight:\n" + details)}`;
          const emailLink = `mailto:sales@flighttoz.com?subject=Flight Booking Request&body=${encodeURIComponent(details)}`;
          html += `
            <div class="p-4 border rounded-lg bg-white shadow mb-4">
              <p><strong>Airline:</strong> ${f.airline}</p>
              <p><strong>Flight:</strong> ${f.flight}</p>
              <p><strong>From:</strong> ${f.from}</p>
              <p><strong>To:</strong> ${f.to}</p>
              <p><strong>Departure:</strong> ${f.dep}</p>
              <p><strong>Status:</strong> ${f.status}</p>
              <hr class="my-2">
              <p><strong>Price:</strong> ${f.priceCAD} CAD | ${f.priceUSD} USD | â‚¹${f.priceINR} INR</p>
              <p><strong>Duration:</strong> ${f.duration} mins</p>
              <div class="flex gap-2 mt-3">
                <a href="${whatsappLink}" target="_blank" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">ðŸ“² WhatsApp</a>
                <a href="${emailLink}" target="_blank" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg">ðŸ“§ Email</a>
              </div>
            </div>`;
        });
      }
      document.getElementById("results").innerHTML = html;
    }

    // Sorting
    function sortFlights(type) {
      let sorted = [...flights];
      if (type === "price") sorted.sort((a,b) => a.priceCAD - b.priceCAD);
      if (type === "duration") sorted.sort((a,b) => a.duration - b.duration);
      if (type === "departure") sorted.sort((a,b) => new Date(a.dep) - new Date(b.dep));
      renderFlights(sorted);
    }

    // Filters
    function applyFilters() {
      let filtered = [...flights];

      if (document.getElementById("filterNonStop").checked) {
        filtered = filtered.filter(f => f.duration < 300);
      }
      const airline = document.getElementById("filterAirline").value;
      if (airline) filtered = filtered.filter(f => f.airline === airline);

      const region = document.getElementById("filterRegion").value;
      if (region) {
        const canada = ["YYZ","YVR","YUL","YYC","YEG"];
        const usa = ["JFK","EWR","LAX","ORD","DFW","SFO","MIA","BOS"];
        const india = ["DEL","BOM","BLR","MAA","CCU"];
        filtered = filtered.filter(f => {
          if (region === "Canada") return canada.includes(f.from) || canada.includes(f.to);
          if (region === "USA") return usa.includes(f.from) || usa.includes(f.to);
          if (region === "India") return india.includes(f.from) || india.includes(f.to);
        });
      }

      const maxPrice = document.getElementById("filterPrice").value;
      if (maxPrice) filtered = filtered.filter(f => f.priceCAD <= maxPrice);

      renderFlights(filtered);
    }

    // Event listeners
    document.getElementById("filterNonStop").addEventListener("change", applyFilters);
    document.getElementById("filterAirline").addEventListener("change", applyFilters);
    document.getElementById("filterRegion").addEventListener("change", applyFilters);
    document.getElementById("filterPrice").addEventListener("input", applyFilters);

    // Form submit
    document.getElementById("searchForm").addEventListener("submit", e => {
      e.preventDefault();
      generateFlights();
    });
  </script>
</body>
</html>
